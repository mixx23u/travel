!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="5ff08f5b-cd21-4fae-835a-d098d86c7f5e",e._sentryDebugIdIdentifier="sentry-dbid-5ff08f5b-cd21-4fae-835a-d098d86c7f5e")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9806],{70270:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r={src:"/_next/static/media/chevron_left.7de8e5c0.svg",height:16,width:16,blurWidth:0,blurHeight:0}},34973:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r={src:"/_next/static/media/chevron_right.dcb11c1b.svg",height:14,width:14,blurWidth:0,blurHeight:0}},29806:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>W});var r=n(74848),o=n(96540),l=n(29965),i=n.n(l),a=n(1935),s=n(60842),c=n.n(s),d=n(8299),u=n(89906);let p=(e,t)=>e.filter(e=>{var t,n;return(null===(n=e.geometry)||void 0===n?void 0:null===(t=n.coordinates)||void 0===t?void 0:t.length)===2}).map(e=>({feature:e,screenPoint:t.project([e.geometry.coordinates[0],e.geometry.coordinates[1]])})),v=(e,t)=>({minX:e.x-t,maxX:e.x+t,minY:e.y-t,maxY:e.y+t}),h=(e,t)=>e.x>=t.minX&&e.x<=t.maxX&&e.y>=t.minY&&e.y<=t.maxY,g=(e,t,n,r)=>{let{feature:o,screenPoint:l}=t[e],i=v(l,n),a=[o];for(let n=e+1;n<t.length;n++){let{feature:e,screenPoint:o}=t[n];if(o.x>i.maxX)break;!r.has(e.shortCode)&&h(o,i)&&(a.push(e),r.add(e.shortCode))}for(let n=e-1;n>=0;n--){let{feature:e,screenPoint:o}=t[n];if(o.x<i.minX)break;!r.has(e.shortCode)&&h(o,i)&&(a.push(e),r.add(e.shortCode))}return a},m=(e,t)=>({...e,allVideos:t});var f=n(82872),x=n(65848),b=n(58001),y=n(70510),k=n(70270),C=n(34973),j=n(257),_=n.n(j);let M=e=>{let{videoFeatures:t,currentVideoIndex:n=0,totalVideos:o=1,onClose:l,onExpand:a,onPrevVideo:s,onNextVideo:c}=e,d=t[0];return d?(0,r.jsx)("div",{className:_().video_panel,children:(0,r.jsxs)("div",{className:_().video_container,children:[(0,r.jsx)("video",{className:_().video_player,src:"https://cdn.dev.beautifuldestinations.app/".concat(d.mp4Url),autoPlay:!0,muted:!0,loop:!0,playsInline:!0}),(0,r.jsx)("button",{className:_().video_panel_close_button,onClick:l,children:(0,r.jsx)(i(),{src:b.A,alt:"close",width:12,height:12})}),(0,r.jsx)("button",{className:_().video_panel_expand_button,onClick:a,children:(0,r.jsx)(i(),{src:y.A,alt:"expand",width:12,height:12})}),o>1&&(0,r.jsxs)("div",{className:_().video_counter,children:[n+1," / ",o]}),o>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:s,className:_().nav_button_left,children:(0,r.jsx)(i(),{src:k.A,alt:"previous",width:16,height:16})}),(0,r.jsx)("button",{onClick:c,className:_().nav_button_right,children:(0,r.jsx)(i(),{src:C.A,alt:"next",width:16,height:16})})]})]})}):null};var w=n(99558),E=n(13718);let A=async e=>{var t;let{features:n,position:r,videoIndex:l=0,mapRef:i,videoPopupRef:a}=e,s=null===(t=i.current)||void 0===t?void 0:t.getMap();if(!s)return;a.current&&a.current.remove();let c=await (0,f.XV)(),d=()=>{a.current&&(a.current.remove(),a.current=null)},u=()=>{d();let e=(0,E.Cd)(n);(0,w.u)({videos:e,initialIndex:l})},p=()=>{let e=(l-1+n.length)%n.length;A({features:n,position:r,videoIndex:e,mapRef:i,videoPopupRef:a})},v=()=>{let e=(l+1)%n.length;A({features:n,position:r,videoIndex:e,mapRef:i,videoPopupRef:a})},h=(0,x.qV)(o.createElement(()=>o.createElement(M,{videoFeatures:[n[l]],currentVideoIndex:l,totalVideos:n.length,onClose:d,onExpand:u,onPrevVideo:p,onNextVideo:v}))),g=new c({className:"video-marker-popup",closeButton:!1,offset:[0,-10]}).setLngLat([r.lng,r.lat]).setHTML(h).addTo(s),m=g.getElement();if(m){m.style.zIndex="10000";let e=m.querySelector(".mapboxgl-popup-content");e&&(e.style.padding="0",e.style.borderRadius="8px",e.style.overflow="visible")}a.current=g,setTimeout(()=>{let e=g.getElement();if(!e)return;let t=e.querySelector('button[class*="close_button"]');null==t||t.addEventListener("click",d);let n=e.querySelector('button[class*="expand_button"]');null==n||n.addEventListener("click",u);let r=e.querySelector('button[class*="nav_button_left"]');null==r||r.addEventListener("click",p);let o=e.querySelector('button[class*="nav_button_right"]');null==o||o.addEventListener("click",v)},100)},S=e=>{let{thumbnailUrl:t,size:n=40,borderWidth:o=3}=e,l=n-2*o,i=.4*n,a=n+i;return(0,r.jsxs)("svg",{width:n,height:a,viewBox:"0 0 ".concat(n," ").concat(a),xmlns:"http://www.w3.org/2000/svg",style:{overflow:"visible"},children:[(0,r.jsxs)("defs",{children:[(0,r.jsx)("clipPath",{id:"circle-clip-".concat(n),children:(0,r.jsx)("circle",{cx:n/2,cy:n/2,r:l/2})}),(0,r.jsxs)("linearGradient",{id:"instagram-gradient-".concat(n),x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#F58529"}),(0,r.jsx)("stop",{offset:"25%",stopColor:"#DD2A7B"}),(0,r.jsx)("stop",{offset:"50%",stopColor:"#8134AF"}),(0,r.jsx)("stop",{offset:"75%",stopColor:"#515BD4"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#8134AF"})]})]}),(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:"\n            M ".concat(n/2," ").concat(n,"\n            C ").concat(.25*n," ").concat(n,", 0 ").concat(.75*n,", 0 ").concat(n/2,"\n            C 0 ").concat(.225*n,", ").concat(.225*n," 0, ").concat(n/2," 0\n            C ").concat(.775*n," 0, ").concat(n," ").concat(.225*n,", ").concat(n," ").concat(n/2,"\n            C ").concat(n," ").concat(.75*n,", ").concat(.75*n," ").concat(n,", ").concat(n/2," ").concat(n,"\n            L ").concat(n/2," ").concat(a,"\n            Z\n          "),fill:"url(#instagram-gradient-".concat(n,")"),stroke:"white",strokeWidth:"1"}),(0,r.jsx)("circle",{cx:n/2,cy:n/2,r:l/2,fill:"white",stroke:"url(#instagram-gradient-".concat(n,")"),strokeWidth:o}),t?(0,r.jsx)("image",{x:o,y:o,width:l,height:l,href:t,clipPath:"url(#circle-clip-".concat(n,")"),preserveAspectRatio:"xMidYMid slice"}):(0,r.jsx)("circle",{cx:n/2,cy:n/2,r:l/2,fill:"#E0E0E0"})]})]})};var N=n(73404),L=n(58312),I=n.n(L);n(50265);var P=n(81445);let T=(0,o.memo)(e=>{let{markers:t=[],center:n,bounds:l,zoom:s=2,forceBoundsFitting:v=!1,initialViewState:h,onMarkerClick:f,onMapClick:x,onMapLoad:b,onZoomEnd:y,renderMarker:k,activeMarkerId:C,hoveredMarkerId:j,onMarkerHover:_,showVideoFeatures:M=!1,videoFeaturesMinZoom:w=11,onVideoFeatureClick:E,style:L,padding:T=N.e2,containerClassName:W,children:R,maxZoom:q=18,minZoom:F=1,scrollZoom:V=!0,doubleClickZoom:B=!0,dragPan:z=!0,dragRotate:D=!0,touchZoomRotate:Z=!0,attributionControl:H=!1,animationDuration:U=800,maxAnimationDuration:X=800,userLocation:Y,mapConfig:J={},isMultiSelectMode:O=!1,mapRef:G}=e,Q="pk.eyJ1IjoiZW1pcnBhc2ljYmQiLCJhIjoiY2xoaG0yYjFoMGQ0cjNncHJtbW1sMWR0bCJ9.3KdSTp0dU-mhebvFMhU5BQ",K=t.length>0,$=o.Children.count(R)>0;if(K&&$&&console.warn("Map component: Both markers prop and children are provided. Use either markers prop with renderMarker function OR children components to render markers, never both. See documentation for proper usage patterns."),K&&!k)throw Error("Map component: renderMarker function is required when using markers prop. Provide a renderMarker function or use children components instead.");let ee=(0,o.useRef)(null),et=G||ee,en=(0,o.useRef)(null),er=(0,o.useRef)(null),eo=(0,o.useRef)(t),[el,ei]=(0,o.useState)(null),[ea,es]=(0,o.useState)(!1),[ec,ed]=(0,o.useState)(null),eu=(0,o.useRef)(null),[ep,ev]=(0,o.useState)([]),[eh,eg]=(0,o.useState)(!1),em=(0,d.A)(t),ef=(0,d.A)(C),{mapStyle:ex=N.jJ,vectorTileSourceUrl:eb=N.bp,vectorTileSourceLayer:ey=N.Dh}=J,ek=(0,o.useMemo)(()=>{if(l)return l;if(0===t.length)return;let e=new(c()).LngLatBounds;return t.forEach(t=>{t&&e.extend([t.longitude,t.latitude])}),e},[l,t]),eC=(0,o.useMemo)(()=>{if(n)return n;if(ek){let e=ek.getCenter();return{lat:e.lat,lng:e.lng}}return Y&&0===t.length?{lat:Y.lat,lng:Y.lng}:{lat:0,lng:0}},[n,ek,Y,t.length]),ej=(0,o.useCallback)((e,t)=>{if(e){var n,r,o,l,i;let a={padding:null!==(o=null==t?void 0:t.padding)&&void 0!==o?o:T,duration:null!==(l=null==t?void 0:t.duration)&&void 0!==l?l:U,maxDuration:null!==(i=null==t?void 0:t.maxDuration)&&void 0!==i?i:X,animate:(null==t?void 0:t.animate)!==!1};null===(r=et.current)||void 0===r||null===(n=r.stop())||void 0===n||n.fitBounds(e,a),er.current=e}},[T,U,X,et]),e_=(0,o.useCallback)(()=>{if(!M||!et.current)return;let e=et.current.getMap();if(!e)return;if(e.getZoom()<w){ev([]),eg(!1);return}eg(!0);let t=e.queryRenderedFeatures({layers:[ey]});t&&t.length>0?ev(function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[20,40,60,80,100],o=null===(n=t.current)||void 0===n?void 0:n.getMap();if(!o||0===e.length)return[];let l=p(e,o).sort((e,t)=>e.screenPoint.x-t.screenPoint.x),i=new Set,a=[];for(let e=0;e<l.length;e++){let{feature:t}=l[e];if(i.has(t.shortCode))continue;let n=r.map(t=>g(e,l,t,i)).find(e=>e.length>1)||[t];i.add(t.shortCode),a.push(m(t,n))}return a}(t.filter(e=>{var t;return e.properties&&(null===(t=e.geometry)||void 0===t?void 0:t.type)==="Point"}).map(e=>({...e.properties,geometry:{coordinates:e.geometry.coordinates||[]}})),et)):ev([]),eg(!1)},[M,et,ey,w]),eM=(0,o.useCallback)(()=>{var e,t;let n=null===(t=et.current)||void 0===t?void 0:null===(e=t.getMap())||void 0===e?void 0:e.getCanvas();n&&(n.style.cursor="grabbing")},[et]),ew=(0,o.useCallback)(()=>{var e,t;let n=null===(t=et.current)||void 0===t?void 0:null===(e=t.getMap())||void 0===e?void 0:e.getCanvas();n&&(n.style.cursor="grab")},[et]),eE=(0,o.useCallback)(()=>{try{var e,n,r;let o=null===(e=et.current)||void 0===e?void 0:e.getMap();if(!o){console.warn("Map instance not available during load, retrying...");return}let l=null===(r=et.current)||void 0===r?void 0:null===(n=r.getContainer())||void 0===n?void 0:n.querySelector(".mapboxgl-ctrl-logo");l&&(l.style.display="none"),M&&((()=>{if(o.getSource(ey)){setTimeout(()=>{e_()},1e3);return}o.once("sourcedata",e=>{if(e.sourceId===ey&&e.isSourceLoaded){setTimeout(()=>{e_()},1e3);return}})})(),o.on("moveend",e_)),o.on("mousedown",eM),o.on("mouseup",ew),ek&&(t.length>0||v)&&!C&&setTimeout(()=>{ej(ek)},100),es(!0),ed(null),null==b||b()}catch(t){console.error("Map load error:",t);let e=t instanceof Error?t.message:"Map load failed";(e.includes("token")||e.includes("network")||e.includes("unauthorized"))&&ed(e)}},[et,M,eM,ew,ek,t.length,v,C,b,e_,ey,ej]),eA=(0,o.useCallback)(e=>{console.error("Map error:",e);let t=e instanceof Error?e.message:String(e);(t.includes("token")||t.includes("network")||t.includes("unauthorized"))&&ed(t)},[]),eS=(0,o.useCallback)(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;A({features:e,position:t,videoIndex:n,mapRef:et,videoPopupRef:eu})},[et]),eN=(0,o.useCallback)(e=>{var t,n,r,o,l;let i=null===(t=e.originalEvent)||void 0===t?void 0:t.target;(null==i?void 0:null===(n=i.closest)||void 0===n?void 0:n.call(i,".mapboxgl-marker"))||(null==i?void 0:null===(r=i.classList)||void 0===r?void 0:r.contains("marker"))||(null==i?void 0:null===(l=i.parentElement)||void 0===l?void 0:null===(o=l.classList)||void 0===o?void 0:o.contains("marker"))||(eu.current&&(eu.current.remove(),eu.current=null),null==x||x(e),null==f||f())},[x,f]),eL=(0,o.useCallback)(e=>{var t,n;let r=Math.max(((null===(t=et.current)||void 0===t?void 0:t.getZoom())||s)+1,11);null===(n=et.current)||void 0===n||n.easeTo({center:[e.longitude,e.latitude],zoom:r,duration:1e3}),null==f||f(e)},[et,s,f]);(0,o.useEffect)(()=>{eo.current=t},[t]),(0,o.useEffect)(()=>{let e=o.Children.count(R)>0,n=void 0!==ef&&void 0===C;if(ea&&ek&&t.length>0&&!C&&!e&&(!O||n)){let e=setTimeout(()=>{ej(ek)},200);return()=>clearTimeout(e)}},[ea,ek,t.length,ej,C,R,O,ef]),(0,o.useEffect)(()=>{let e=o.Children.count(R)>0;if(C||e||(er.current=null),em&&em.length>0&&0===t.length){var n;null===(n=et.current)||void 0===n||n.easeTo({center:Y?[Y.lng,Y.lat]:[0,0],zoom:Y?7:3,duration:1e3,padding:0})}},[t.length,Y,em,et,C,R]),(0,o.useEffect)(()=>{let e=en.current;if(!e)return;let t=(0,P.A)(function(){var e;null===(e=et.current)||void 0===e||e.resize(),er.current&&!C&&ej(er.current)},100),n=0,r=new ResizeObserver(()=>{cancelAnimationFrame(n),n=requestAnimationFrame(()=>t())});return r.observe(e),()=>{cancelAnimationFrame(n),r.disconnect()}},[ej,C,et]),(0,o.useEffect)(()=>{let e=et.current;return()=>{eu.current&&(eu.current.remove(),eu.current=null);let t=null==e?void 0:e.getMap();t&&M&&t.off("moveend",e_)}},[M,e_,et]);let eI=(0,o.useMemo)(()=>{var e;if((null===(e=et.current)||void 0===e?void 0:e.isStyleLoaded())&&(null==Y?void 0:Y.label))return new(c()).Popup({offset:25}).setText(Y.label)},[Y,et]),eP=h||{longitude:eC.lng,latitude:eC.lat,zoom:ek&&(t.length>0||v)?v?s:3:s};return Q?ec?(0,r.jsx)("div",{className:(0,u.A)(I().mapContainer,W),style:L,children:(0,r.jsx)("div",{style:{padding:"20px",textAlign:"center"},children:"Map temporarily unavailable"})}):(0,r.jsx)("div",{ref:en,className:(0,u.A)(I().mapContainer,W),style:L,children:(0,r.jsxs)(a.Ay,{ref:et,mapboxAccessToken:Q,initialViewState:eP,mapStyle:ex,onLoad:eE,onError:eA,onClick:eN,onZoomEnd:y,maxZoom:q,minZoom:F,scrollZoom:V,doubleClickZoom:B,dragPan:z,dragRotate:D,touchZoomRotate:Z,attributionControl:H,projection:J.projection,children:[M&&(0,r.jsx)(a.kL,{id:ey,type:"vector",url:eb,children:(0,r.jsx)(a.Wd,{id:ey,type:"circle",source:eb,"source-layer":ey,paint:{"circle-opacity":0,"circle-radius":1}})}),M&&!eh&&ep.map(e=>{var t;let n=(null===(t=e.geometry)||void 0===t?void 0:t.coordinates)||[];return 2!==n.length?null:(0,r.jsx)(a.pH,{longitude:n[0],latitude:n[1],anchor:"bottom",style:{zIndex:1},onClick:t=>{t.originalEvent.stopPropagation(),eS(e.allVideos.map(e=>{let{...t}=e;return t}),{lng:n[0],lat:n[1]})},children:(0,r.jsxs)("div",{className:I().videoMarkerWrapper,style:{cursor:"pointer",position:"relative"},children:[(0,r.jsx)(S,{thumbnailUrl:e.thumbnailUrl?"https://cdn.dev.beautifuldestinations.app/".concat(e.thumbnailUrl):void 0,size:40,borderWidth:3}),e.allVideos.length>1&&(0,r.jsx)("div",{style:{position:"absolute",top:"-5px",right:"-5px",backgroundColor:"#FF4B7D",color:"white",borderRadius:"12px",fontSize:"10px",fontWeight:"bold",padding:"2px 6px",minWidth:"16px",textAlign:"center",lineHeight:"12px",border:"2px solid white",boxShadow:"0 1px 3px rgba(0,0,0,0.3)"},children:e.allVideos.length})]})},e.shortCode)}),Y&&(0,r.jsx)(a.pH,{longitude:Y.lng,latitude:Y.lat,popup:eI,anchor:"bottom",children:(0,r.jsx)("div",{className:I().userLocationMarker,children:(0,r.jsx)(i(),{src:Y.icon||"/ChatSidePanelAISearch/markers/pov_destination_pin.svg",alt:"Your location",width:40,height:46})})}),k&&t.map(e=>{let t=C===e.id,n=j===e.id||el===e.id;return(0,r.jsx)(a.pH,{longitude:e.longitude,latitude:e.latitude,onClick:()=>eL(e),anchor:"bottom",style:t||n?N.Eq.ACTIVE:N.Eq.INACTIVE,popup:e.popup,children:(0,r.jsx)("div",{className:I().markerWrapper,onMouseEnter:()=>{ei(e.id),null==_||_(e.id)},onMouseLeave:()=>{ei(null),null==_||_(void 0)},children:k(e,t,n)})},"".concat(e.id,"-").concat(e.longitude,"-").concat(e.latitude))}),R]})}):(console.error("Map component: NEXT_PUBLIC_MAPBOX_ACCESS_TOKEN is required"),(0,r.jsx)("div",{className:(0,u.A)(I().mapContainer,W),style:L,children:"Map unavailable"}))});T.displayName="Map";let W=T},50265:()=>{},58312:e=>{e.exports={mapContainer:"Map_mapContainer__6a1yj",userLocationMarker:"Map_userLocationMarker___vPu1",markerWrapper:"Map_markerWrapper__H48PA",videoMarkerWrapper:"Map_videoMarkerWrapper__aUg5d"}}}]);