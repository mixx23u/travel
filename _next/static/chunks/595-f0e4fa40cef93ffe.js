!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c8136fb2-8a32-47b4-a0fb-5e6f7cb034a8",e._sentryDebugIdIdentifier="sentry-dbid-c8136fb2-8a32-47b4-a0fb-5e6f7cb034a8")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[595],{20181:(e,t,i)=>{var n=0/0,s=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,o=/^0o[0-7]+$/i,l=parseInt,c="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,d="object"==typeof self&&self&&self.Object===Object&&self,u=c||d||Function("return this")(),h=Object.prototype.toString,g=Math.max,p=Math.min,f=function(){return u.Date.now()};function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if("symbol"==typeof(t=e)||t&&"object"==typeof t&&"[object Symbol]"==h.call(t))return n;if(b(e)){var t,i="function"==typeof e.valueOf?e.valueOf():e;e=b(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var c=a.test(e);return c||o.test(e)?l(e.slice(2),c?2:8):r.test(e)?n:+e}e.exports=function(e,t,i){var n,s,r,a,o,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof e)throw TypeError("Expected a function");function x(t){var i=n,r=s;return n=s=void 0,c=t,a=e.apply(r,i)}function v(e){var i=e-l,n=e-c;return void 0===l||i>=t||i<0||u&&n>=r}function y(){var e,i,n,s=f();if(v(s))return w(s);o=setTimeout(y,(e=s-l,i=s-c,n=t-e,u?p(n,r-i):n))}function w(e){return(o=void 0,h&&n)?x(e):(n=s=void 0,a)}function j(){var e,i=f(),r=v(i);if(n=arguments,s=this,l=i,r){if(void 0===o)return c=e=l,o=setTimeout(y,t),d?x(e):a;if(u)return o=setTimeout(y,t),x(l)}return void 0===o&&(o=setTimeout(y,t)),a}return t=m(t)||0,b(i)&&(d=!!i.leading,r=(u="maxWait"in i)?g(m(i.maxWait)||0,t):r,h="trailing"in i?!!i.trailing:h),j.cancel=function(){void 0!==o&&clearTimeout(o),c=0,n=l=s=o=void 0},j.flush=function(){return void 0===o?a:w(f())},j}},30157:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let n=(0,i(73943).A)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]])},55947:(e,t,i)=>{"use strict";i.d(t,{Bc:()=>a,ZI:()=>c,k$:()=>l,m_:()=>o});var n=i(31170),s=i(3881),r=i(74848);function a({delayDuration:e=0,...t}){return(0,r.jsx)(s.Kq,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function o({...e}){return(0,r.jsx)(a,{children:(0,r.jsx)(s.bL,{"data-slot":"tooltip",...e})})}function l({...e}){return(0,r.jsx)(s.l9,{"data-slot":"tooltip-trigger",...e})}function c({className:e,sideOffset:t=0,children:i,...a}){return(0,r.jsx)(s.ZL,{children:(0,r.jsxs)(s.UC,{"data-slot":"tooltip-content",sideOffset:t,className:(0,n.cn)("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...a,children:[i,(0,r.jsx)(s.i3,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}a.displayName="TooltipProvider",o.displayName="Tooltip",l.displayName="TooltipTrigger",c.displayName="TooltipContent"},33071:(e,t,i)=>{"use strict";i.d(t,{U:()=>b,a:()=>j});var n=i(57011),s=i(72111),r=i(31170),a=i(96540),o=i(23174),l=i(76897),c=i(98097),d=i(48311),u=i(92955),h=i(74848),g=i(22732),p=({creditText:e,upgradeButtonLabel:t,onUpgrade:i,onClose:n})=>(0,h.jsxs)("div",{className:"self-stretch px-2.5 md:px-4 lg:px-6 py-1.5 rounded-tr-lg inline-flex justify-start items-center gap-2",children:[(0,h.jsx)("div",{className:"flex-1 inline-flex flex-col justify-start items-start gap-0.5",children:(0,h.jsx)("span",{className:"self-stretch justify-start text-sm text-popover-foreground leading-tight",children:e})}),(0,h.jsxs)("button",{className:"h-6 px-2 bg-foreground rounded-md flex justify-center items-center gap-1",onClick:i,children:[(0,h.jsx)(o.A,{className:"size-3 text-primary-foreground",strokeWidth:2}),(0,h.jsx)("span",{className:"justify-center text-primary-foreground text-xs font-semibold leading-none",children:t})]}),(0,h.jsx)("button",{className:"h-6 w-6 flex justify-center items-center text-foreground hover:text-foreground transition-colors",onClick:n,"aria-label":"Close notification",children:(0,h.jsx)(l.A,{className:"size-6"})})]}),f=({suggestions:e,suggestionDuration:t,pauseDuration:i,isInputEmpty:n})=>(0,h.jsx)("div",{"aria-hidden":!0,className:(0,r.cn)("suggestion-placeholder absolute left-2.5 right-2.5 top-3.5 md:left-4 md:right-4 lg:left-6 lg:right-6 pointer-events-none text-muted-foreground",n?"opacity-100":"opacity-0"),style:{"--suggestion-duration":`${t}ms`,"--pause-duration":`${i}ms`,"--count":e.length},children:e.map((e,t)=>(0,h.jsx)("span",{className:"suggestion-text line-clamp-2",style:{"--i":t},children:e},t))}),b=(0,g.F)("relative w-full min-w-3xs rounded-3xl lg:rounded-4xl inline-flex flex-col justify-start items-start overflow-hidden",{variants:{variant:{default:"bg-secondary [&_.prompt-text-area]:bg-background [&_.prompt-text-area]:border [&_.prompt-text-area]:border-input [&_.prompt-text-area]:min-h-30","landing-page":"bg-background max-w-3xl [&_.prompt-text-area]:bg-background [&_.prompt-text-area]:border [&_.prompt-text-area]:border-input [&_.prompt-text-area]:min-h-36 shadow-lg"}},defaultVariants:{variant:"default"}}),m=({textareaProps:e,onSend:t,isSendButtonLoading:i=!1,disableSendButton:n=!1})=>{let[s,r]=a.useState(e.value||""),[o,l]=a.useState(!1),c=a.useRef(null);a.useEffect(()=>{void 0!==e.value&&r(e.value)},[e.value]);let d=void 0!==e.value,u=i||o,h=!s||!s.toString().trim().length,g=a.useMemo(()=>n||e.disabled||u||h,[n,e.disabled,u,h]),p=a.useCallback(t=>{r(t.target.value),e.onChange?.(t)},[e]),f=a.useCallback(async()=>{if(!g&&s.trim())try{l(!0);let e=t?.(s);e&&"function"==typeof e.then&&await e,d||r("")}catch(e){globalThis.console.error("Send failed:",e)}finally{l(!1)}},[s,g,t,d]),b=a.useCallback(t=>{if("Enter"===t.key){if(t.shiftKey)return;t.preventDefault(),f()}e.onKeyDown?.(t)},[e,f]);return{inputValue:s,isCombinedLoading:u,isSendButtonDisabled:g,textareaRef:c,handleInputChange:p,handleSend:f,handleKeyDown:b}},x=({actionButtons:e=[]})=>{let[t,i]=a.useState(!1),n=a.useRef(null);return a.useEffect(()=>{let e=()=>{if(n.current){let{scrollWidth:e,clientWidth:t}=n.current;i(e>t)}};e();let t=new globalThis.ResizeObserver(e);return n.current&&t.observe(n.current),()=>{t.disconnect()}},[e]),{areActionButtonsOverflowing:t,scrollContainerRef:n}},v=(e,t)=>{let i=a.useCallback(()=>{let t=e.current;if(!t)return;t.style.height="auto";let i=parseInt(window.getComputedStyle(t).lineHeight),n=Math.min(t.scrollHeight,8*i);t.style.height=`${n}px`},[e]);return a.useEffect(()=>{i()},[t,i]),{adjustTextareaHeight:i}},y=({textareaRef:e,disabled:t})=>({handleContainerClick:a.useCallback(i=>{let n=i.target,s=null!==n.closest("button"),r=null!==n.closest("textarea");s||r||t||e.current?.focus()},[e,t])}),w=()=>{let[e,t]=a.useState(!1);return{isNotificationClosed:e,handleCloseNotification:a.useCallback(()=>{t(!0)},[])}},j=a.forwardRef(({className:e,variant:t,showCreditNotification:i=!1,creditText:o="1 free credit remaining today",upgradeButtonLabel:l="Upgrade",onUpgrade:g,actionButtons:j=[],onSend:C,isSendButtonLoading:T=!1,sendButtonLabel:R,voiceRecorderElement:S,disableSendButton:N=!1,placeholderSuggestions:k=[],suggestionDuration:L=2e3,pauseDuration:A=500,uploadedFileCards:E=[],...z},D)=>{let M=m({textareaProps:z,onSend:C,isSendButtonLoading:T,disableSendButton:N}),O=x({actionButtons:j}),_=y({textareaRef:M.textareaRef,disabled:z.disabled}),$=w();v(M.textareaRef,M.inputValue);let I=!M.inputValue||!M.inputValue.toString().trim().length;return a.useImperativeHandle(D,()=>M.textareaRef.current),(0,h.jsxs)("div",{className:(0,r.cn)(b({variant:t,className:e})),onClick:_.handleContainerClick,children:[i&&!$.isNotificationClosed&&(0,h.jsx)(p,{creditText:o,upgradeButtonLabel:l,onUpgrade:g,onClose:$.handleCloseNotification}),(0,h.jsxs)("div",{className:"prompt-text-area self-stretch rounded-3xl lg:rounded-4xl outline-input inline-flex flex-col justify-between items-start overflow-hidden",children:[(0,h.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-2 lg:gap-2.5",children:[E.length>0&&(0,h.jsx)("div",{className:"self-stretch flex flex-col md:flex-row md:flex-wrap gap-2 pt-2 lg:pt-2.5 px-2.5 md:px-4 lg:px-6",children:E.map((e,t)=>(0,h.jsx)("div",{children:e},t))}),(0,h.jsx)("div",{className:"self-stretch rounded-lg inline-flex justify-start items-start gap-1",children:(0,h.jsxs)("div",{className:"relative flex-1",children:[(0,h.jsx)(n.T,{...z,ref:M.textareaRef,placeholder:k?.length?"\xa0":z.placeholder,value:M.inputValue,onChange:M.handleInputChange,onKeyDown:M.handleKeyDown,disabled:z.disabled,className:"dark:bg-transparent border-0 shadow-none focus-visible:ring-0 resize-none overflow-y-auto px-2.5 md:px-4 lg:px-6 pt-3.5 w-full pb-2",rows:1}),!!k?.length&&(0,h.jsx)(f,{suggestions:k,suggestionDuration:L,pauseDuration:A,isInputEmpty:I})]})})]}),(0,h.jsxs)("div",{className:"self-stretch relative",children:[(0,h.jsxs)("div",{className:(0,r.cn)("flex min-w-0 relative w-full items-center justify-between px-2.5 pb-2.5 pt-1.5 md:px-4 md:pb-3.5 lg:px-6 lg:pb-3.5 gap-2 transition-all duration-300 ease-out",M.isCombinedLoading?"opacity-0 pointer-events-none":"opacity-100"),children:[(0,h.jsx)("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:(0,h.jsxs)("div",{className:"relative flex-1 min-w-0 overflow-hidden",children:[(0,h.jsx)("div",{className:"overflow-x-auto scrollbar-none",ref:O.scrollContainerRef,children:(0,h.jsx)("div",{className:"flex justify-start items-center gap-1 w-max",children:j?.map((e,t)=>h.jsx(s.$,{variant:e.label?"outline":null,size:e.label?"sm":"icon",onClick:e.onClick,leftIcon:e.label?h.jsx(h.Fragment,{children:h.jsx("span",{className:"hidden md:block",children:e.icon||h.jsx(c.A,{className:"size-4"})})}):void 0,rightIcon:e.label?void 0:e.icon||h.jsx(c.A,{className:"size-4"}),className:r.cn(e.label?"text-xs":void 0,e.label||0!==t?void 0:"justify-start w-fit hover:scale-110"),children:e.label},t))})}),O.areActionButtonsOverflowing&&(0,h.jsx)("div",{className:"absolute inset-y-0 right-0 w-20 bg-gradient-to-l from-background via-background/90 to-transparent pointer-events-none"})]})}),(0,h.jsxs)("div",{className:"flex items-center gap-4 ml-2",children:[S,(0,h.jsx)(s.$,{size:R?"default":"icon",onClick:M.handleSend,disabled:M.isSendButtonDisabled,leftIcon:(0,h.jsx)(d.A,{className:"size-4"}),"aria-label":R||"Send",children:R})]})]}),(0,h.jsx)("div",{className:(0,r.cn)("flex min-w-0 absolute inset-0 w-full items-center justify-end px-2.5 pb-2.5 pt-1.5 md:px-4 md:pb-3.5 lg:px-6 lg:pb-3.5 gap-2 transition-all duration-300 ease-out",M.isCombinedLoading?"opacity-100":"opacity-0 pointer-events-none"),children:(0,h.jsx)("div",{className:"flex items-center justify-center size-9",children:(0,h.jsx)(u.A,{className:"size-4.5 animate-spin text-primary"})})})]})]})]})});j.displayName="PromptBox"},57011:(e,t,i)=>{"use strict";i.d(t,{T:()=>a});var n=i(31170),s=i(96540),r=i(74848),a=s.forwardRef(({className:e,...t},i)=>(0,r.jsx)("textarea",{ref:i,"data-slot":"textarea",className:(0,n.cn)("border-input placeholder:text-muted-foreground placeholder:text-sm lg:placeholder:text-base focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-sm lg:text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 break-word",e),...t}));a.displayName="Textarea"},93671:(e,t,i)=>{"use strict";let n;function s(e,t,i,n,s,r,a){try{var o=e[r](a),l=o.value}catch(e){i(e);return}o.done?t(l):Promise.resolve(l).then(n,s)}function r(e){return function(){var t=this,i=arguments;return new Promise(function(n,r){var a=e.apply(t,i);function o(e){s(a,n,r,o,l,"next",e)}function l(e){s(a,n,r,o,l,"throw",e)}o(void 0)})}}i.d(t,{A:()=>L,V:()=>k});var a=i(96540),o=i(20181);let l="undefined"!=typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),c=e=>e===l;var d=()=>/(android)/i.test("undefined"!=typeof navigator?navigator.userAgent:"");let u=(...e)=>e.map(e=>e.trim()).join(" ").trim(),h=/\s*\((.*?)\)\s*/g,g=/(\(\?:[^)]+\))\?/g,p=/(\(\?)?:\w+/g,f=/\*/g,b=/[-{}[\]+?.,\\^$|#]/g,m=e=>e instanceof RegExp?RegExp(e.source,"i"):RegExp("^"+(e=e.replace(b,"\\$&").replace(h,"(?:$1)?").replace(p,(e,t)=>t?e:"([^\\s]+)").replace(f,"(.*?)").replace(g,"\\s*$1?\\s*"))+"$","i"),x=(e,t)=>{if(e=e.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!e.length&&!t.length)return 1;if(!e.length||!t.length)return 0;if(e===t)return 1;if(1===e.length&&1===t.length||e.length<2||t.length<2)return 0;let i=new Map;for(let t=0;t<e.length-1;t++){let n=e.substring(t,t+2),s=i.has(n)?i.get(n)+1:1;i.set(n,s)}let n=0;for(let e=0;e<t.length-1;e++){let s=t.substring(e,e+2),r=i.has(s)?i.get(s):0;r>0&&(i.set(s,r-1),n++)}return 2*n/(e.length+t.length-2)},v=()=>"undefined"!=typeof window&&void 0!==window.navigator&&void 0!==window.navigator.mediaDevices&&void 0!==window.navigator.mediaDevices.getUserMedia&&(void 0!==window.AudioContext||void 0!==window.webkitAudioContext);class y{setSpeechRecognition(e){let t=!!e&&(c(e)||v());t&&(this.disableRecognition(),this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(t)}subscribe(e,t){this.subscribers[e]=t}unsubscribe(e){delete this.subscribers[e]}emitListeningChange(e){this.listening=e,Object.keys(this.subscribers).forEach(t=>{let{onListeningChange:i}=this.subscribers[t];i(e)})}emitMicrophoneAvailabilityChange(e){this.isMicrophoneAvailable=e,Object.keys(this.subscribers).forEach(t=>{let{onMicrophoneAvailabilityChange:i}=this.subscribers[t];i(e)})}emitTranscriptChange(e,t){Object.keys(this.subscribers).forEach(i=>{let{onTranscriptChange:n}=this.subscribers[i];n(e,t)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(e=>{let{onClearTranscript:t}=this.subscribers[e];t()})}emitBrowserSupportsSpeechRecognitionChange(e){Object.keys(this.subscribers).forEach(t=>{let{onBrowserSupportsSpeechRecognitionChange:i,onBrowserSupportsContinuousListeningChange:n}=this.subscribers[t];i(e),n(e)})}disconnect(e){if(this.recognition&&this.listening)switch(e){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(e){e&&e.error&&"not-allowed"===e.error&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:e,resultIndex:t}){let i=void 0===t?e.length-1:t;this.interimTranscript="",this.finalTranscript="";for(let t=i;t<e.length;++t)e[t].isFinal&&(!d()||e[t][0].confidence>0)?this.updateFinalTranscript(e[t][0].transcript):this.interimTranscript=u(this.interimTranscript,e[t][0].transcript);let n=!1;""===this.interimTranscript&&""!==this.finalTranscript?(this.previousResultWasFinalOnly&&(n=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,n||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(e){this.finalTranscript=u(this.finalTranscript,e)}resetTranscript(){this.disconnect("RESET")}startListening(){return r(function*({continuous:e=!1,language:t}={}){if(!this.recognition)return;let i=e!==this.recognition.continuous,n=t&&t!==this.recognition.lang;if((i||n)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=i?e:this.recognition.continuous,this.recognition.lang=n?t:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(e){e instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return r(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}stopListening(){return r(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}getRecognition(){return this.recognition}start(){return r(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(e){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(e),d()&&(this.updateFinalTranscript=o(this.updateFinalTranscript,250,{leading:!0}))}}let w="CLEAR_TRANSCRIPT",j="APPEND_TRANSCRIPT",C=()=>({type:w}),T=(e,t)=>({type:j,payload:{interimTranscript:e,finalTranscript:t}}),R=(e,t)=>{switch(t.type){case w:return{interimTranscript:"",finalTranscript:""};case j:return{interimTranscript:t.payload.interimTranscript,finalTranscript:u(e.finalTranscript,t.payload.finalTranscript)};default:throw Error()}},S=!!l,N=S&&!d(),k=({transcribing:e=!0,clearTranscriptOnListen:t=!0,commands:i=[]}={})=>{let[n]=(0,a.useState)(L.getRecognitionManager()),[s,r]=(0,a.useState)(S),[o,l]=(0,a.useState)(N),[{interimTranscript:c,finalTranscript:d},h]=(0,a.useReducer)(R,{interimTranscript:n.interimTranscript,finalTranscript:""}),[g,p]=(0,a.useState)(n.listening),[f,b]=(0,a.useState)(n.isMicrophoneAvailable),v=(0,a.useRef)(i);v.current=i;let y=()=>{h(C())},w=(0,a.useCallback)(()=>{n.resetTranscript(),y()},[n]),j=(e,t,i)=>{let n=("object"==typeof e?e.toString():e).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),s=x(n,t);return s>=i?{command:e,commandWithoutSpecials:n,howSimilar:s,isFuzzyMatch:!0}:null},k=(e,t)=>{let i=m(e).exec(t);return i?{command:e,parameters:i.slice(1)}:null},A=(0,a.useCallback)((e,t)=>{v.current.forEach(({command:i,callback:n,matchInterim:s=!1,isFuzzyMatch:r=!1,fuzzyMatchingThreshold:a=.8,bestMatchOnly:o=!1})=>{let l=!t&&s?e.trim():t.trim(),c=(Array.isArray(i)?i:[i]).map(e=>r?j(e,l,a):k(e,l)).filter(e=>e);if(r&&o&&c.length>=2){c.sort((e,t)=>t.howSimilar-e.howSimilar);let{command:e,commandWithoutSpecials:t,howSimilar:i}=c[0];n(t,l,i,{command:e,resetTranscript:w})}else c.forEach(e=>{if(e.isFuzzyMatch){let{command:t,commandWithoutSpecials:i,howSimilar:s}=e;n(i,l,s,{command:t,resetTranscript:w})}else{let{command:t,parameters:i}=e;n(...i,{command:t,resetTranscript:w})}})})},[w]),E=(0,a.useCallback)((t,i)=>{e&&h(T(t,i)),A(t,i)},[A,e]),z=(0,a.useCallback)(()=>{t&&y()},[t]);return(0,a.useEffect)(()=>{let e=L.counter;return L.counter+=1,n.subscribe(e,{onListeningChange:p,onMicrophoneAvailabilityChange:b,onTranscriptChange:E,onClearTranscript:z,onBrowserSupportsSpeechRecognitionChange:r,onBrowserSupportsContinuousListeningChange:l}),()=>{n.unsubscribe(e)}},[e,t,n,E,z]),{transcript:u(d,c),interimTranscript:c,finalTranscript:d,listening:g,isMicrophoneAvailable:f,resetTranscript:w,browserSupportsSpeechRecognition:s,browserSupportsContinuousListening:o}},L={counter:0,applyPolyfill:e=>{n?n.setSpeechRecognition(e):n=new y(e);let t=!!e&&v();S=t,N=t},removePolyfill:()=>{n?n.setSpeechRecognition(l):n=new y(l),N=(S=!!l)&&!d()},getRecognitionManager:()=>(n||(n=new y(l)),n),getRecognition:()=>L.getRecognitionManager().getRecognition(),startListening:({continuous:e,language:t}={})=>r(function*(){let i=L.getRecognitionManager();yield i.startListening({continuous:e,language:t})})(),stopListening:()=>r(function*(){let e=L.getRecognitionManager();yield e.stopListening()})(),abortListening:()=>r(function*(){let e=L.getRecognitionManager();yield e.abortListening()})(),browserSupportsSpeechRecognition:()=>S,browserSupportsContinuousListening:()=>N}}}]);